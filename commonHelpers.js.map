{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\nconst galleryContainer = document.querySelector('.gallery');\nconst loaderContainer = document.getElementById('loader');\nconst searchForm = document.getElementById('search-form');\nconst loadMoreBtn = document.getElementById('load-more');\nconst loadingIndicator = document.getElementById('loading-indicator');\n\nconst apiKey = '42175181-9f2e4ea0c75ffabf50c3ef9f9';\nlet currentPage = 1;\nlet currentQuery = '';\nlet currentImagesCount = 0;\nlet totalHits = 0;\nlet isBatmanCarSearch = false;\n\nfunction toastSuccess(message) {\n    iziToast.success({\n        title: 'Success',\n        message: message,\n        position: 'topRight'\n    });\n}\n\nfunction toastError(message) {\n    iziToast.error({\n        title: 'Error',\n        message: message,\n        position: 'topRight'\n    });\n}\n\nfunction toggleLoadMoreBtn(show) {\n    loadMoreBtn.style.display = show ? 'block' : 'none';\n}\n\nfunction toggleLoader(show) {\n    loaderContainer.style.display = show ? 'block' : 'none';\n    loadingIndicator.style.display = show ? 'block' : 'none';\n}\n\nasync function searchImages(query, page = 1) {\n    const url = `https://pixabay.com/api/?key=${apiKey}&q=${encodeURIComponent(query)}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=15`;\n    try {\n        const response = await axios.get(url);\n        totalHits = response.data.totalHits;\n        return response.data.hits;\n    } catch (error) {\n        toastError('Failed to fetch images.');\n        throw error;\n    }\n}\n\nasync function scrollToNextGroup() {    \n    const cardHeight = galleryContainer.querySelector('.image-card').getBoundingClientRect().height;\n    window.scrollBy({\n        top: 2 * cardHeight,\n        left: 0,\n        behavior: 'smooth'\n    });\n}\n\nasync function performSearch(query, page) {\n    try {\n        toggleLoader(true);\n        const images = await searchImages(query, page);\n        if (images.length > 0) {\n            if (page === 1) {\n                displayImages(images);\n            } else {\n                appendImages(images);\n            }\n            toastSuccess(`Was found: ${images.length} images`);\n            initializeLightbox();\n            if (images.length < 15) {\n                toastError('We are sorry, but you have reached the end of search results.');\n                toggleLoadMoreBtn(false);\n            } else {\n                toggleLoadMoreBtn(true);\n            }\n            scrollToNextGroup();\n        } else {\n            galleryContainer.innerHTML = '';\n            toastError(`Sorry, there are no images matching your search query \"${query}\". Please try again!`);\n            toggleLoadMoreBtn(false);\n        }\n    } finally {\n        toggleLoader(false);\n    }\n}\n\nsearchForm.addEventListener('submit', async function (event) {\n    event.preventDefault();\n    toggleLoadMoreBtn(false);\n    const query = document.getElementById('query').value.trim();\n    if (!query) {\n        iziToast.warning({ title: 'Warning', message: 'Please enter a search query.' });\n        return;\n    }\n    currentQuery = query;\n    currentPage = 1;\n    if (query.toLowerCase() === 'batman car') {\n        isBatmanCarSearch = true;\n        await performSearch(query, currentPage);\n    } else {\n        isBatmanCarSearch = false;\n        await performSearch(query, currentPage);\n    }\n});\n\nloadMoreBtn.addEventListener('click', async function () {\n    try {\n        toggleLoader(true);\n        currentPage++;\n        await performSearch(currentQuery, currentPage);\n    } catch (error) {\n        toastError('Failed to fetch additional images.');\n    } finally {\n        toggleLoader(false);\n    }\n});\n\nfunction displayImages(images) {\n    galleryContainer.innerHTML = '';\n    const fragment = document.createDocumentFragment();\n    images.forEach(image => {\n        const { largeImageURL, webformatURL, tags, likes, views, comments, downloads } = image;\n        const imageCard = document.createElement('div');\n        imageCard.classList.add('image-card');\n        imageCard.innerHTML = `\n            <a href=\"${largeImageURL}\" data-lightbox=\"image-set\" data-title=\"${tags}\">\n                <img src=\"${webformatURL}\" alt=\"${tags}\">\n                <div class=\"info\">Likes: ${likes}, Views: ${views}, Comments: ${comments}, Downloads: ${downloads}</div>\n            </a>\n        `;\n        fragment.appendChild(imageCard);\n    });\n    galleryContainer.appendChild(fragment);\n    currentImagesCount += images.length;   \n}\n\nfunction appendImages(images) {\n    const fragment = document.createDocumentFragment();\n    images.forEach(image => {\n        const { largeImageURL, webformatURL, tags, likes, views, comments, downloads } = image;\n        const imageCard = document.createElement('div');\n        imageCard.classList.add('image-card');\n        imageCard.innerHTML = `\n            <a href=\"${largeImageURL}\" data-lightbox=\"image-set\" data-title=\"${tags}\">\n                <img src=\"${webformatURL}\" alt=\"${tags}\">\n                <div class=\"info\">Likes: ${likes}, Views: ${views}, Comments: ${comments}, Downloads: ${downloads}</div>\n            </a>\n        `;\n        fragment.appendChild(imageCard);\n    });\n    galleryContainer.appendChild(fragment);\n    currentImagesCount += images.length;   \n}\n\nfunction initializeLightbox() {\n    new SimpleLightbox('.gallery a').refresh();\n}\n"],"names":["galleryContainer","loaderContainer","searchForm","loadMoreBtn","loadingIndicator","apiKey","currentPage","currentQuery","currentImagesCount","totalHits","toastSuccess","message","iziToast","toastError","toggleLoadMoreBtn","show","toggleLoader","searchImages","query","page","url","response","axios","error","scrollToNextGroup","cardHeight","performSearch","images","displayImages","appendImages","initializeLightbox","event","fragment","image","largeImageURL","webformatURL","tags","likes","views","comments","downloads","imageCard","SimpleLightbox"],"mappings":"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"}